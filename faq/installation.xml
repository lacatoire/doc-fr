<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision$ -->
<!-- EN-Revision: 2dbf3d9064d4cb07f0a2f7d06641c877a2e5ed24 Maintainer: yannick Status: ready -->
<!-- Reviewed: yes -->

 <chapter xml:id="faq.installation" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">
  <title>Installation</title>
  <titleabbrev>Installation</titleabbrev>

  <para>
   Cette section traite de questions courantes sur la façon d'installer PHP.
   PHP est disponible sur la plupart des systèmes d'exploitation et pour
   quasiment n'importe quel serveur web.
  </para>
  <para>
   Pour installer PHP, suivre les instructions présentes dans <xref linkend="install"/>.
  </para>

  <qandaset>
   <qandaentry xml:id="faq.installation.apache2">
    <question>
     <para>
      Pourquoi ne doit-on pas utiliser Apache 2 dans un environnement threadé
      multiprocesseur de production ?
     </para>
    </question>
    <answer>
     <para>
      PHP est un mortier. C'est un mortier utilisé pour construire de belles
      applications web en utilisant beaucoup de bibliothèques ensemble,
      apparaissant comme une seule entité à travers un langage intuitif et
      facile à apprendre. La flexibilité et la puissance de PHP se fondent sur
      la stabilité et la robustesse de la plate-forme fondamentale. Il a besoin
      d'un OS qui fonctionne, d'un serveur web qui fonctionne et de bibliothèques
      externes pour coller le tout. Lorsqu'un seul de ces éléments arrête subitement
      de fonctionner, PHP doit identifier le problème et le réparer au plus vite.
      En rendant le cadre fondamental plus complexe en ne séparant pas les exécutions
      des threads, ni les segments mémoires, ni un endroit clos pour traiter chaque requête
      entrante, de nouvelles faiblesses sont introduites dans le système PHP.
     </para>
     <para>
      Pour utiliser un MPM threadé, il est possible de regarder du côté
      d'une configuration FastCGI dans laquelle PHP s'exécute dans son propre espace
      mémoire.
     </para>
    </answer>
   </qandaentry>

   <qandaentry xml:id="faq.installation.phpini">
    <question>
     <para>
      Unix/Windows : où doit être placé mon fichier &php.ini; ?
     </para>
    </question>
    <answer>
     <para>
      Par défaut sous Unix, il doit être placé dans <filename>/usr/local/lib</filename>
      qui est en fait <filename>&lt;install-path&gt;/lib</filename>.
      La plupart des personnes voudront changer ceci lors de la compilation
      avec l'option <link
      linkend="configure.with-config-file-path">--with-config-file-path</link>.
      Il est par exemple possible de le régler de cette façon :
      <programlisting role="shell">
--with-config-file-path=/etc
      </programlisting>
      Il suffit ensuite de copier le fichier <filename>php.ini-development</filename> livré
      avec les sources vers <filename>/etc/php.ini</filename> et de l'éditer pour
      l'adapter aux besoins locaux.
     </para>
      <programlisting role="shell">
--with-config-file-scan-dir=PATH
      </programlisting>
     <para>
      Sous Windows, le chemin par défaut de &php.ini; est le répertoire de
      Windows. Lors de l'utilisation du serveur web Apache, &php.ini; est tout
      d'abord cherché dans le répertoire d'installation d'Apache, par exemple
      <filename>c:\program files\apache group\apache</filename>. De cette
      façon, il est possible d'avoir un &php.ini; différent pour chaque version
      d'Apache installée.
     </para>
     <para>
     Consulter aussi le chapitre sur le
     <link linkend="configuration.file">fichier de configuration</link>.
     </para>
    </answer>
   </qandaentry>

   <qandaentry xml:id="faq.installation.nodata">
    <question>
     <para>
      Unix : j'ai installé PHP, mais à chaque fois que je charge un
      document, j'obtiens l'erreur 'Document Contains No Data' ! Que se
      passe-t-il ?
     </para>
    </question>
    <answer>
     <para>
      Cela signifie probablement que PHP rencontre un problème et génère un
      fichier core. Il convient de consulter les fichiers de logs du serveur pour voir
      si c'est le cas, et de tenter de reproduire le problème avec un test
      simple. En cas de maîtrise de 'gdb', il serait très utile de fournir un
      backtrace avec le rapport de bogue, afin d'aider les développeurs à
      cerner le problème. Lors de l'utilisation de PHP en module Apache, il est possible d'essayer
      ceci :
      <itemizedlist>
       <listitem>
        <para>
         Stopper les processus httpd
        </para>
       </listitem>
       <listitem>
        <para>
         gdb httpd
        </para>
       </listitem>
       <listitem>
        <para>
         Stopper les processus httpd
        </para>
       </listitem>
       <listitem>
        <para>
         &gt; run -X -f /path/to/httpd.conf
        </para>
       </listitem>
       <listitem>
        <para>
         Pointer alors avec le navigateur vers l'URL posant problème.
        </para>
       </listitem>
       <listitem>
        <para>
         &gt; run -X -f /path/to/httpd.conf
        </para>
       </listitem>
       <listitem>
        <para>
         En cas de fichier core, gdb doit alors en informer.
        </para>
       </listitem>
       <listitem>
        <para>
         taper : bt
        </para>
       </listitem>
       <listitem>
        <para>
         Il convient d'inclure le backtrace dans le rapport de bogue.
         Celui-ci doit être posté sur
         <link xlink:href="&url.php.bugs;">&url.php.bugs;</link>.
        </para>
       </listitem>
      </itemizedlist>
     </para>
     <para>
      Si le script utilise les expressions régulières
      (<function>preg_match</function> et consorts), il faut s'assurer que PHP et
      Apache ont été compilés avec les mêmes outils d'expressions régulières.
      Cela doit être automatiquement le cas avec PHP et Apache 1.3.x.
     </para>
    </answer>
   </qandaentry>

   <qandaentry xml:id="faq.installation.processing">
    <question>
     <para>
      Unix : J'ai installé PHP en utilisant des fichiers sources RPM, mais
      apache ne traite pas les pages PHP. Que se passe-t-il ?
     </para>
    </question>
    <answer>
     <para>
      En supposant qu'Apache et PHP ont été installés à partir
      de fichiers RPM, il faut commenter ou ajouter au moins quelques-unes
      des lignes suivantes dans le fichier &httpd.conf; :
      <programlisting role="apache-conf">
<![CDATA[
# Extra Modules
AddModule mod_php.c
AddModule mod_perl.c

# Extra Modules
LoadModule php_module         modules/mod_php.so
LoadModule php5_module        modules/libphp5.so
LoadModule perl_module        modules/libperl.so
]]>
      </programlisting>
      Et ajouter :
      <programlisting role="apache-conf">
<![CDATA[
AddType application/x-httpd-php .php
]]>
      </programlisting>
      ... aux propriétés globales ou aux propriétés du VirtualDomain où
      PHP doit officier.
     </para>
    </answer>
   </qandaentry>

   <qandaentry xml:id="faq.installation.frontpage">
    <question>
     <para>
      Unix : J'ai patché Apache avec l'extension FrontPage et subitement, PHP
      ne fonctionne plus.
      Est-ce que PHP est incompatible avec l'extension FrontPage pour Apache ?
     </para>
    </question>
    <answer>
     <para>
      Non, PHP fonctionne très bien avec l'extension FrontPage. Le souci vient du fait
      que le patch pour l'installation de FrontPage modifie la structure d'Apache,
      qui est relié à PHP.
      Recompiler PHP (en utilisant 'make clean ; make') après avoir patché Apache avec
      l'extension FrontPage devrait résoudre ce problème.
     </para>
    </answer>
   </qandaentry>

   <qandaentry xml:id="faq.installation.blankscreen">
    <question>
     <para>
      Unix/Windows : J'ai installé PHP, mais lorsque je tente d'accéder à un fichier
      contenant un script PHP via mon navigateur, j'obtiens un écran vide.
     </para>
    </question>
    <answer>
     <para>
      En affichant le code source du document dans le navigateur, il est
      probable d'y trouver le code source du script PHP.
      Cela signifie que le serveur web n'a pas envoyé le script à PHP pour
      interprétation. Quelque chose est donc incorrect dans le fichier de configuration
      du serveur web - il convient de re-vérifier la configuration du serveur web en se
      référant aux instructions d'installation
      de PHP.
     </para>
    </answer>
   </qandaentry>

   <qandaentry xml:id="faq.installation.500error">
    <question>
     <para>
      Unix/Windows : J'ai installé PHP, mais lorsque je tente d'accéder à un fichier contenant un
      script PHP via mon navigateur, j'obtiens une erreur de type 'server 500 error'.
     </para>
    </question>
    <answer>
     <para>
      Quelque chose se passe mal lorsque le serveur tente d'utiliser PHP.
      Pour tenter de récupérer un message d'erreur, depuis la ligne de commande,
      se placer dans le répertoire contenant l'exécutable PHP
      (<filename>php.exe</filename> sous Windows) et exécuter la commande
      <command>php -i</command>.
      Si PHP a un problème quelconque l'empêchant de fonctionner, un message
      d'erreur devrait s'afficher qui devrait expliquer comment résoudre ce souci. Si un
      écran de code HTML apparaît (la sortie de la fonction
      <function>phpinfo</function>),
      cela signifie que PHP fonctionne correctement et que le problème doit
      certainement venir de la configuration du serveur web qu'il convient de
      re-vérifier.
     </para>
    </answer>
   </qandaentry>

   <qandaentry xml:id="faq.installation.undefinedsyms">
    <question>
     <para>
      Quelques systèmes d'exploitation : J'ai installé PHP sans erreur, mais lorsque
      je tente de démarrer Apache, j'obtiens une erreur du type
      '<literal>Undefined symbols</literal>' :
      <programlisting role="shell">
[mybox:user /src/php5] root# apachectl configtest
 apachectl: /usr/local/apache/bin/httpd Undefined symbols:
  _compress
  _uncompress
      </programlisting>
     </para>
    </question>
    <answer>
     <para>
      Cela n'a actuellement rien à voir avec PHP mais avec la bibliothèque cliente
      MySQL. Suivant les versions, elle a besoin que PHP soit compilé avec l'option
      <option role="configure">--with-zlib</option>, d'autres non.
      Ce problème est également traité dans la FAQ de MySQL.
     </para>
    </answer>
   </qandaentry>

   <qandaentry xml:id="faq.installation.cgierror">
    <question>
     <para>
      Windows : J'ai installé PHP, mais lorsque je tente d'accéder à un fichier contenant un script PHP
      via mon navigateur, j'obtiens l'erreur :
      <screen>
<![CDATA[
cgi error:
 The specified CGI application misbehaved by not
 returning a complete set of HTTP headers.
 The headers it did return are:
]]>
      </screen>
     </para>
    </question>
    <answer>
     <para>
      Ce message d'erreur signifie que PHP a échoué lors de l'affichage.
      Pour tenter de récupérer un message d'erreur, depuis la ligne de commande,
      se placer dans le répertoire contenant l'exécutable PHP
      (<filename>php.exe</filename> sous Windows) et exécuter la commande
      <command>php -i</command>. Si PHP a un quelconque souci de
      fonctionnement, alors un message d'erreur le décrivant s'affichera. Si un
      écran de code HTML apparaît (le contenu du résultat de la fonction
      <function>phpinfo</function>), alors PHP fonctionne
      correctement.
     </para>
     <para>
      Si PHP fonctionne depuis la ligne de commande, tenter d'accéder au script
      encore une fois via le navigateur. Si cela échoue toujours, alors, il se peut que ce
      soit l'un des soucis suivants :
     </para>
     <itemizedlist>
      <listitem>
       <simpara>
        Les permissions du script PHP, des fichiers <filename>php.exe</filename>,
        <filename>php5ts.dll</filename>, &php.ini; ou de toute extension nécessaire à PHP
        à charger, sont telles que l'utilisateur internet anonyme du système
        <literal>ISUR_&lt;machinename&gt;</literal> ne peut pas y accéder.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Le script PHP n'existe pas (ou n'est pas à l'endroit supposé, relativement au
        répertoire racine du serveur web). Il est à noter que pour le serveur web IIS, il est possible de
        vérifier cela en cochant la case 'vérifier si le fichier existe' lors de la configuration
        de l'exécution des scripts dans le gestionnaire de services Internet. Si un fichier de script
        n'existe pas, le serveur web retournera une erreur 404. IIS a également
        l'avantage d'effectuer toutes les identifications requises automatiquement,
        basés sur les permissions NTLanMan, sur le fichier de script.
       </simpara>
      </listitem>
     </itemizedlist>
    </answer>
   </qandaentry>

   <qandaentry xml:id="faq.installation.phpandiis">
    <question>
     <para>
      Windows : J'ai suivi toutes les instructions, mais je n'arrive toujours pas à faire fonctionner
      PHP et IIS ensemble !
     </para>
    </question>
    <answer>
     <para>
      Il faut s'assurer que chaque utilisateur qui a besoin d'exécuter un script PHP
      possède les droits requis pour exécuter le fichier
      <filename>php.exe</filename> !
      IIS utilise un utilisateur anonyme qui est ajouté lors de l'installation de IIS.
      Cet utilisateur doit avoir les droits suffisants sur le fichier
      <filename>php.exe</filename>. De même, tous les utilisateurs enregistrés
      doivent posséder les droits requis pour exécuter le fichier
      <filename>php.exe</filename>.
      Pour IIS4, il faut lui indiquer que PHP est un moteur de script.
      De plus, il est recommandé de lire cette <link
      linkend="faq.installation.forceredirect">FAQ</link>.
     </para>
    </answer>
   </qandaentry>

   <qandaentry xml:id="faq.installation.forceredirect">
    <question>
     <para>
      Lors de l'exécution de PHP comme CGI avec IIS, PWS, OmniHTTPD ou Xitami,
      l'erreur suivante apparaît : <literal>Security Alert! PHP CGI
       cannot be accessed directly.</literal>.
     </para>
    </question>
    <answer>
     <para>
      Il faut définir la directive <link linkend="ini.cgi.force-redirect">
      cgi.force_redirect</link> à &zero;. Par défaut, elle vaut &one;, donc,
      il faut s'assurer que cette directive n'est pas commentée (précédée d'un point virgule).
      Comme toutes les directives, elles sont définies dans le &php.ini;.
     </para>
     <para>
      Comme la valeur par défaut vaut &one;, il est impératif de s'assurer
      à 100% que le bon fichier &php.ini; a été lu.
      Il est recommandé de lire cette <link linkend="faq.installation.findphpini">FAQ</link>
      pour plus de détails.
     </para>
    </answer>
   </qandaentry>

   <qandaentry xml:id="faq.installation.findphpini">
    <question>
     <para>
      Comment puis-je savoir si mon &php.ini; a bien été trouvé et lu ?
      Cela semble être le cas mais aucun de mes changements n'ont eu d'effet.
     </para>
    </question>
    <answer>
     <para>
      Pour s'assurer que le &php.ini; a été lu par PHP, effectuer un appel à la fonction
      <function>phpinfo</function>. Vers le haut du document résultant, il devrait figurer
      une liste appelée <literal>Configuration File (php.ini)</literal>.
      Cela indiquera où PHP a cherché le &php.ini; et si oui ou non il l'a lu.
      Si seul un dossier <envar>PATH</envar> existe et que le fichier n'est pas lu,
      il faut copier le &php.ini; dans ce dossier. Si le &php.ini; est présent dans le
      chemin, cela signifie qu'il a bien été lu.
     </para>
     <para>
      Si le &php.ini; a bien été lu et que PHP s'exécute comme module,
      alors il faut s'assurer de redémarrer le serveur web après avoir effectué les modifications
      au &php.ini;.
     </para>
     <para>
      Voir aussi la fonction <function>php_ini_loaded_file</function>.
     </para>
    </answer>
   </qandaentry>

   <qandaentry xml:id="faq.installation.addtopath">
    <question>
     <para>
      Où dois-je ajouter mon répertoire PHP à la variable <envar>PATH</envar>
      sous Windows ?
     </para>
    </question>
    <answer>
     <para>
      Sous Windows :
      <itemizedlist>
       <listitem><para>
        Aller dans le centre de contrôle et ouvrir l'icône système (Démarrer → Paramètres
        → Panneau de configuration → Système ou juste Démarrer → centre de contrôle
        → Système pour Windows XP/2003+)
       </para></listitem>
       <listitem><para>
        Aller à l'onglet "Avancé"
       </para></listitem>
       <listitem><para>
        Cliquer sur le bouton "Variables d'environnements"
       </para></listitem>
       <listitem><para>
        Regarder dans le panneau "Variables systèmes"
       </para></listitem>
       <listitem><para>
        Trouver l'entrée <literal>Path</literal> (il peut être nécessaire de faire descendre
        l'ascenseur pour la trouver)
       </para></listitem>
       <listitem><para>
        Double cliquer sur l'entrée <literal>Path</literal>
       </para></listitem>
       <listitem><para>
        Entrer le répertoire PHP à la fin, sans oublier le point virgule (<literal>;</literal>)
        avant (par exemple <literal>;C:\php</literal>)
       </para></listitem>
       <listitem><para>
        Confirmer en cliquant sur <literal>OK</literal>
       </para></listitem>
      </itemizedlist>
     </para>
     <note>
      <simpara>
       Il faut redémarrer l'ordinateur après avoir suivi cette procédure
       afin que les modifications sur la variable <envar>PATH</envar>
       soient bien prises en compte.
      </simpara>
     </note>
    </answer>
   </qandaentry>

   <qandaentry xml:id="faq.installation.phprc">
    <question>
     <para>
      Comment rendre le fichier &php.ini; disponible à PHP sous Windows ?
     </para>
    </question>
    <answer>
     <para>
      Il y a plusieurs façons de faire cela. En cas d'utilisation d'Apache,
      se référer à la documentation d'Apache, sinon il faut définir
      la variable d'environnement <varname>PHPRC</varname>.
     </para>
    </answer>
   </qandaentry>

   <qandaentry xml:id="faq.installation.windows-temporary-path">
    <question>
     <simpara>
      Windows : Comment puis-je vérifier que PHP peut écrire dans le répertoire temporaire
      sous IIS ?
     </simpara>
    </question>
    <answer>
     <procedure>
      <step>
       <simpara>
        Faire un clic droit sur le répertoire temporaire (<varname>%TEMP%</varname>)
        dans l'Explorateur de fichiers pour obtenir les autorisations.
        Le répertoire temporaire est disponible depuis la configuration ou
        <function>phpinfo</function>.
       </simpara>
      </step>
      <step>
       <simpara>
        Pour IIS, vérifier que l'utilisateur <literal>IIS_User</literal> dispose de
        l'autorisation <literal>MODIFIER</literal>.
       </simpara>
      </step>
     </procedure>
    </answer>
   </qandaentry>

   <qandaentry xml:id="faq.installation.apache.multiviews">
    <question>
     <para>
      Est-il possible d'utiliser la négociation sur le contenu fournie par Apache (option
      MultiViews) avec PHP ?
     </para>
    </question>
    <answer>
     <para>
      Si les liens vers les fichiers PHP incluent l'extension, tout fonctionne
      parfaitement. Cette entrée de la FAQ traite uniquement du cas où les liens
      vers les fichiers PHP n'incluent pas l'extension et qu'il est souhaité
      utiliser la négociation sur le contenu fourni par Apache pour choisir les
      fichiers PHP depuis une URL qui ne contient pas d'extension. Dans ce
      cas, remplacer la ligne
      <literal>AddType application/x-httpd-php .php</literal> par :
      <programlisting role="apache-conf">
<![CDATA[
AddHandler php5-script php
AddType text/html php
]]>
     </programlisting>
     Cette solution ne fonctionne pas pour Apache 1 car le module PHP
     ne captura pas le <literal>php-script</literal>.
     </para>
    </answer>
   </qandaentry>

   <qandaentry xml:id="faq.installation.requestmethods">
    <question>
     <para>
      Est-ce que PHP est limité au traitement des méthodes GET et POST ?
     </para>
    </question>
    <answer>
     <para>
      Non, il est possible de gérer tout type de méthode, comme CONNECT. Le
      bon statut de réponse peut être envoyé avec la fonction
      <function>header</function>. Si seules les méthodes POST et GET doivent
      être gérées, il est possible de configurer Apache comme ce qui suit :
      <programlisting role="apache-conf">
<![CDATA[
<LimitExcept GET POST>
Deny from all
</LimitExcept>
]]>
     </programlisting>
     </para>
    </answer>
   </qandaentry>
  </qandaset>
 </chapter>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
